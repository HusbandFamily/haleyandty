<body>
    <div class="container">
        <!-- Secret Code Section -->
        <div id="codeSection">
            <h2>Enter Your Guest Code</h2>
            <input type="text" id="guestCodeInput" placeholder="Enter your code">
            <button onclick="checkCode()">Submit</button>
            <p id="errorMessage" style="color: red; display: none;">Invalid code. Try again.</p>
        </div>

        <!-- Hidden RSVP Form -->
        <div id="formSection" style="display: none;">
            <form id="contactForm">
                <label>What is your name?</label>
                <input type="text" name="name" placeholder="Your Name" required>

                <label>Are you planning to attend the wedding?</label>
                <input type="radio" name="weddingAttendance" value="Yes" required> Yes
                <input type="radio" name="weddingAttendance" value="No" required> No

                <label>Will you attend the welcome party?</label>
                <select name="welcomeParty">
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                    <option value="Maybe">Maybe</option>
                </select>

                <label>Will you attend the pool party?</label>
                <select name="poolParty">
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                    <option value="Maybe">Maybe</option>
                </select>

                <label>Do you have any dietary restrictions?</label>
                <textarea name="diet" placeholder="Your Dietary Restrictions"></textarea>

                <label>Red or White Wine?</label>
                <select name="winePreference">
                    <option value="Red">Red</option>
                    <option value="White">White</option>
                    <option value="Juice">Juice</option>
                </select>

                <button type="submit">Submit</button>
            </form>
        </div>

        <!-- Thank You Message -->
        <div id="thankYouMessage" style="display: none;">
            <h3>Thank you for responding!</h3>
            <p>We are so excited to have you join us for the big day!</p>
            <a href="http://haleyandty.com" target="_blank">Wedding Day Details</a>  <!-- Link to the wedding details -->
        </div>
    </div>

<script>
    const validCodes = {
        "Husband": "Husband",
        "Clarke": "Clarke",
    };

    function checkCode() {
        const codeInput = document.getElementById('guestCodeInput').value.trim().toUpperCase();
        const errorMessage = document.getElementById('errorMessage');
        const formSection = document.getElementById('formSection');
        const codeSection = document.getElementById('codeSection');
        const nameField = document.querySelector('input[name="name"]');
        const hiddenCodeField = document.getElementById('hiddenCode');

        if (validCodes.hasOwnProperty(codeInput)) {
            // Valid code - reveal the form
            codeSection.style.display = 'none';
            formSection.style.display = 'block';
            nameField.value = validCodes[codeInput];
            hiddenCodeField.value = codeInput;
        } else {
            // Invalid code - show error message
            errorMessage.style.display = 'block';
            document.getElementById('guestCodeInput').classList.add('shake');

            setTimeout(() => {
                document.getElementById('guestCodeInput').classList.remove('shake');
            }, 500);
        }
    }

    // Handle Form Submission
    const scriptURL = "https://script.google.com/macros/s/AKfycbxYJj35YzZKOhYvjI4DRLxihvbYupkJEp_OCVu4OrWLoe3e7FxeTzycglWeFHxUoDd-/exec";
    const form = document.getElementById('contactForm');

    form.addEventListener('submit', function(e) {
        e.preventDefault();

        fetch(scriptURL, {
            method: "POST",
            body: new URLSearchParams(new FormData(form))
        })
        .then(response => response.text())
        .then(data => {
            if (data === "Success") {
                // Hide the form and show the "Thank You" message
                form.reset();
                document.getElementById('formSection').style.display = 'none';
                document.getElementById('thankYouMessage').style.display = 'block';
            } else {
                alert("There was an error submitting your RSVP. Please try again.");
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("There was an error processing your RSVP.");
        });
    });

    // Handle Enter key press to submit the code
    document.getElementById('guestCodeInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            checkCode();
        }
    });
</script>

<style>
    .shake {
        animation: shake 0.2s ease-in-out;
    }

    @keyframes shake {
        0% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        50% { transform: translateX(5px); }
        75% { transform: translateX(-5px); }
        100% { transform: translateX(0); }
    }
</style>

</body>
